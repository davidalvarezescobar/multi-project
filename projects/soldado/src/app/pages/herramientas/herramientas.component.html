<h5 *ngIf="ventana === 'inventario'">Inventario de herramientas para control de FOD</h5>
<h5 *ngIf="ventana === 'historial'">Histórico de inventario de herramientas para control de FOD</h5>

<div *ngIf="ventana === 'inventario'">
    <details>
        <summary>Filtros:</summary>
        <form>
            <fieldset>
                <div class="filtros">
                    <label class="short" style="max-width: 150px;">
                        <strong>Fecha:</strong>
                        <input type="text" [value]="formatDateConMesEscritoDDMM(fechaActual)"
                            style="border: none; pointer-events: none;" readonly>
                    </label>

                    <label for="turno" class="short">
                        <strong>Turno:</strong>
                        <select id="turno" required>
                            <option value="" selected>Selecciona turno</option>
                            <option *ngFor="let turno of turnos">{{ turno }}</option>
                        </select>
                    </label>

                    <label class="short">
                        <strong>Cajón de herramientas:</strong>
                        <select id="caja" required>
                            <option *ngFor="let caja of cajas">{{ caja }}</option>
                        </select>
                    </label>
                </div>
            </fieldset>
        </form>
    </details>
    <div class="semaforo">
        <i class="semaforo-inventario-green fa-solid fa-circle" *ngIf="semaforoInventario"></i>
        <i class="semaforo-inventario-red fa-solid fa-circle" *ngIf="!semaforoInventario"></i>
    </div>

    <div class="tablas-herramientas">
        <figure>
            <table>
                <thead>
                    <tr>
                        <th scope="col">Herramienta</th>
                        <th class="colSecDatos" scope="col">Entrada: <strong>{{horaEntrada}}</strong></th>
                        <th class="colSecDatos" scope="col">Salida: <strong>{{horaSalida}}</strong></th>
                        <th class="colSecDatos" scope="col">Observaciones:</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let herramienta of herramientas; let i = index"
                        [class.herramientas-error]="!cEntrada[i] || !cSalida[i]">
                        <td>{{ herramienta }}</td>
                        <td class="colSecDatos">
                            <input type="checkbox" #entradaCheckbox class="checkbox-column-herramientas"
                                [checked]="cEntrada[i]" (change)="cEntradaChange(entradaCheckbox.checked, herramienta)"
                                [disabled]="momentoActivo!='Entrada'">
                        </td>
                        <td class="colSecDatos">
                            <input type="checkbox" #salidaCheckbox class="checkbox-column-herramientas"
                                [checked]="cSalida[i]" (change)="cSalidaChange(salidaCheckbox.checked, herramienta)"
                                [disabled]="momentoActivo!='Salida'">
                        </td>
                        <td class="colSecDatos">
                            <a href="javascript:void(0)" (click)="openModalObservacionDatos()"><i class="eye"></i></a>
                        </td>
                    </tr>

                    <tr class="guardar-herramientas">
                        <td></td>
                        <td class="colSecDatos"><button (click)="modalVerificacionHerramietnasEntrada()"
                                [disabled]="momentoActivo!='Entrada'" role="button" style="max-width: 100px;">Guardar</button></td>
                        <td class="colSecDatos"><button (click)="modalVerificacionHerramietnasSalida()"
                                [disabled]="momentoActivo!='Salida'" role="button" style="max-width: 100px;">Guardar</button></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </figure>
    </div>
    <footer>
        <a href="javascript:void(0)" role="button" type="button" (click)="setVentana('historial')">Histórico</a>
    </footer>
</div>

<div *ngIf="ventana === 'historial'">
    <details>
        <summary>Filtros:</summary>
        <form>
            <fieldset>
                <div class="filtros">
                    <label class="short">
                        <strong>Fecha:</strong>
                        <input type="date" [value]="formatDateDDMMYYYY(fechaActual)">
                    </label>
                    <label class="short">
                        <strong>Turno:</strong>
                        <select id="turno" required>
                            <option value="" selected>Seleccione turno</option>
                            <option *ngFor="let turno of turnos">{{ turno }}</option>
                        </select>
                    </label>
                    <label class="short">
                        <strong>Cajón de herramientas:</strong>
                        <select id="caja" required>
                            <option value="" selected>Seleccione una caja</option>
                            <option *ngFor="let caja of cajas">{{ caja }}</option>
                        </select>
                    </label>
                    <label>
                        <strong>Incidencias: </strong>
                        <input type="checkbox" id="incidencias-historico" name="incidencias-historico">
                    </label>
                    <label id="conformidad-label">
                        <strong>Conformidad: </strong>
                        <input type="checkbox" id="conformidad-historico" name="conformidad-historico">
                    </label>
                </div>
            </fieldset>
        </form>
    </details>

    <div class="semaforo">
        <i class="semaforo-historico-green fa-solid fa-circle" *ngIf="semaforoHistorial"></i>
        <i class="semaforo-historico-red fa-solid fa-circle" *ngIf="!semaforoHistorial"></i>
    </div>

    <div class="tablas-herramientas-historico-container">
        <figure>
            <table class="tablas-hitorico-herramientas">
                <thead>
                    <tr>
                        <th scope="col">Turno</th>
                        <th scope="col">Cajon</th>
                        <th scope="col">Herramientas</th>
                        <th scope="col" *ngIf="tipoUsuario != 'User'">Operario</th>
                        <th scope="col">Oficial</th>
                        <th scope="col">Hora entrada</th>
                        <th scope="col">Estado</th>
                        <th scope="col">Hora salida</th>
                        <th scope="col">Estado</th>
                        <th scope="col">Observaciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let fila of historialHerramietnas"
                        [class.herramientas-error]="!fila.estadoSalida || !fila.estadoEntrada">
                        <td>{{ fila.turno }}</td>
                        <td>{{ fila.cajon }}</td>
                        <td>{{ fila.herramienta }}</td>
                        <td *ngIf="tipoUsuario != 'User'">{{ fila.operario }}</td>
                        <td>{{ fila.oficial_al_mando }}</td>
                        <td class="colSecDatos">{{ fila.hora_inventario_entrada }}</td>
                        <td class="colSecDatos"><input type="checkbox" class="checkbox-column-herramientas-historial" min="0" max="20"
                                [checked]="fila.estadoEntrada"></td>
                        <td class="colSecDatos">{{ fila.hora_inventario_salida }}</td>
                        <td class="colSecDatos"><input type="checkbox" class="checkbox-column-herramientas-historial" min="0" max="20"
                                [checked]="fila.estadoSalida"></td>
                        <td class="colSecDatos"><a href="javascript:void(0)"
                                (click)="openModalObservacionHistorico(fila.observacionIncidencia)"><i
                                    class="eye"></i></a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </figure>
    </div>
    <footer>
        <a href="javascript:void(0)" role="button" type="button" (click)="setVentana('inventario')"
            *ngIf="tipoUsuario == 'User'">Volver</a>
    </footer>
</div>

<dialog id="modal-guardar" [attr.open]="modalAdvertenciaEntrada">
    <article>
        <header>
            <a (click)="closeModalAdvertenciaEntrada()" aria-label="Close" class="close"></a>
            <span>Error en la operación de inventario</span>
        </header>
        <div class="modal-container">
            <i class="fa-solid fa-triangle-exclamation fa-2xl" style="color: #ffea00;"></i><br><br>
            <strong>Atención, incidencias encontradas con el inventario de herramientas</strong><br><br>
            <div class="botones-modal-container">
                <a href="javascript:void(0)" (click)="closeModalAdvertenciaEntrada()" role="button"
                    type="button">Volver</a>
                <a href="javascript:void(0)" (click)="openModalGuardarCambioEntrada()" role="button"
                    type="button">Confirmar</a>
            </div>
            <div [hidden]="!objetoRecuperado">
                <br>
                <textarea id="observacionesRecuperacion" class="observacionesRecuperacion"
                    placeholder="Escriba aqui que ocurrio con el material recuperado" cols="50"></textarea>
            </div>
        </div>
    </article>
</dialog>

<dialog id="modal-guardar" [attr.open]="modalAdvertenciaSalida">
    <article>
        <header>
            <a (click)="closeModalAdvertenciaSalida()" aria-label="Close" class="close"></a>
            <span>Error en la operación de inventario</span>
        </header>
        <div class="modal-container">
            <i class="fa-solid fa-triangle-exclamation fa-2xl" style="color: #ffea00;"></i><br><br>
            <strong>Atención, incidencias encontradas con el inventario de herramientas</strong><br><br>
            <div class="botones-modal-container">
                <a href="javascript:void(0)" (click)="closeModalAdvertenciaSalida()" role="button"
                    type="button">Volver</a>
                <a href="javascript:void(0)" (click)="openModalGuardarCambioSalida()" role="button"
                    type="button">Confirmar</a>
            </div>
            <div [hidden]="!objetoRecuperado">
                <br>
                <textarea id="observacionesRecuperacion" class="observacionesRecuperacion"
                    placeholder="Escriba aqui que ocurrio con el material recuperado" cols="50"></textarea>
            </div>
        </div>
    </article>
</dialog>

<dialog id="modal-guardar" [attr.open]="cambiosGuardadosEntrada">
    <article>
        <header>
            <a (click)="closeModalGuardarCambioEntrada()" aria-label="Close" class="close"></a>
            <span>Confirmación de operación de inventario</span>
        </header>
        <div class="modal-container">
            <i class="fa-solid fa-check fa-2xl" style="color: #189100;"></i><br><br>
            <strong>Se ha registrado la información de inventario de herramientas</strong>
        </div>
    </article>
</dialog>

<dialog id="modal-guardar" [attr.open]="cambiosGuardadosSalida">
    <article>
        <header>
            <a (click)="closeModalGuardarCambioSalida()" aria-label="Close" class="close"></a>
            <span>Confirmación de operación de inventario</span>
        </header>
        <div class="modal-container">
            <i class="fa-solid fa-check fa-2xl" style="color: #189100;"></i><br><br>
            <strong>Se ha registrado la información de inventario de herramientas</strong>
        </div>
    </article>
</dialog>

<dialog id="modal-guardar" [attr.open]="modalObservacionHistorial">
    <article>
        <header>
            <a (click)="closeModalObservacionHistorico()" aria-label="Close" class="close"></a>
            <span>Observacion</span>
        </header>
        <div class="modal-container">
            <strong *ngIf="observacionIncidencia != ''">{{observacionIncidencia}}<br><br></strong>
            <a href="javascript:void(0)" (click)="closeModalObservacionHistorico()" role="button"
                type="button">Volver</a>
        </div>
    </article>
</dialog>

<dialog id="modal-guardar" [attr.open]="modalObservacionDatos">
    <article>
        <header>
            <a (click)="closeModalObservacionDatos()" aria-label="Close" class="close"></a>
            <span>Observacion</span>
        </header>
        <div class="modal-container">
            <textarea placeholder="Introduzca su observacion" id="" cols="30" rows="10"></textarea>
            <a href="javascript:void(0)" (click)="closeModalObservacionDatos()" role="button" type="button">Guardar</a>
        </div>
    </article>
</dialog>